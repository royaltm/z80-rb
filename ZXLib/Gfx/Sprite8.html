<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class ZXLib::Gfx::Sprite8 - ruby-Z80</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/navigation.js" defer></script>
<script src="../../js/search.js" defer></script>
<script src="../../js/search_index.js" defer></script>
<script src="../../js/searcher.js" defer></script>
<script src="../../js/darkfish.js" defer></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
<div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  <p class="link"><a href="../../Object.html">Object</a>
</div>

    
    
<div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    <li><a class="extend" href="Sprite8/Macros.html">ZXLib::Gfx::Sprite8::Macros</a>
  </ul>
</div>

    
<!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    <li ><a href="#method-i-draw_sprite8">#draw_sprite8</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-ZXLib::Gfx::Sprite8">
  <h1 id="class-ZXLib::Gfx::Sprite8" class="class">
    class ZXLib::Gfx::Sprite8
  </h1>

  <section class="description">
    
<p>Sprite drawing routines.</p>

<p>See also <a href="Sprite8/Macros.html"><code>ZXLib::Gfx::Sprite8::Macros</code></a>.</p>

<p>By default all drawing method routines are produced. To select only required routines define a <a href="Sprite8.html#DRAW_METHODS"><code>ZXLib::Gfx::Sprite8::DRAW_METHODS</code></a> constant before requiring this file.</p>

<pre class="ruby"><span class="ruby-keyword">module</span> <span class="ruby-constant">ZXLib</span>
  <span class="ruby-keyword">module</span> <span class="ruby-constant">Gfx</span>
    <span class="ruby-keyword">class</span> <span class="ruby-constant">Sprite8</span>
      <span class="ruby-constant">DRAW_METHODS</span> = [<span class="ruby-value">:xor</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;zxlib/gfx/sprite8&#39;</span>
</pre>

  </section>

  <section id="5Buntitled-5D" class="documentation-section">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="CALCULATE_SCREEN_ADDRESS">CALCULATE_SCREEN_ADDRESS
        <dd><p>Configures the method in which <a href="Sprite8.html#method-i-draw_sprite8"><code>draw_sprite8</code></a> calculates the screen address from pixel coordinates.</p>

<p>The routine is 60 bytes in size and can be set up in one of the following ways:</p>
<ul><li><dl class="rdoc-list note-list"><dt><code>:inline</code>
<dd>
<p>The calculation is inline which is faster and backwards compatible but the calculation routine can&#39;t be re-used by <a href="Sprite8/Macros.html#method-i-gfx_sprite8_draw"><code>Macros.gfx_sprite8_draw</code></a> macro.</p>
</dd></dl>
</li><li><dl class="rdoc-list note-list"><dt><code>:subroutine</code>
<dd>
<p>The calculation is set up as a subroutine, which can be reached via <code>draw_sprite8.calc_scr_addr</code> label. See also <a href="Sprite8/Macros.html#method-i-gfx_sprite8_calculate_screen_address"><code>Macros.gfx_sprite8_calculate_screen_address</code></a>.</p>
</dd></dl>
</li><li><dl class="rdoc-list note-list"><dt><code>:external</code>
<dd>
<p>The calculation routine is <em>NOT</em> created. In this instance the only way to call <code>draw_sprite8</code> is via the <a href="Sprite8/Macros.html#method-i-gfx_sprite8_draw"><code>Macros.gfx_sprite8_draw</code></a> macro.</p>
</dd></dl>
</li></ul>
        <dt id="CHECK_HEIGHT_SANITY">CHECK_HEIGHT_SANITY
        <dd><p>Controls if <a href="Sprite8.html#method-i-draw_sprite8"><code>draw_sprite8</code></a> should check if the sprite pixel height is larger than “top lines to skip” parameter.</p>
        <dt id="DRAW_METHODS">DRAW_METHODS
        <dd><p>Array of supported drawing methods: <code>:xor</code>, <code>:or</code>, <code>:set</code>, <code>:mask_or</code></p>
        <dt id="DRAW_METHOD_MASK_OR">DRAW_METHOD_MASK_OR
        <dd>
        <dt id="DRAW_METHOD_OR">DRAW_METHOD_OR
        <dd>
        <dt id="DRAW_METHOD_SET">DRAW_METHOD_SET
        <dd>
        <dt id="DRAW_METHOD_XOR">DRAW_METHOD_XOR
        <dd>
        <dt id="SCREEN_ADDRESS">SCREEN_ADDRESS
        <dd><p>A default screen address used by the routines. You may change this value by overriding label <code>sprite8_screen_address</code> when importing <a href="Sprite8.html"><code>Sprite8</code></a> code.</p>
      </dl>
    </section>



     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-draw_sprite8" class="method-detail ">
        <div class="method-heading">
          <span class="method-name">draw_sprite8</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>

        <div class="method-description">
          <p>Draws a sprite using one of the selected drawing methods with an arbitrary pixel height and width.</p>

<p>Pixel data for sprites must be laid column-wise:</p>

<pre>1st 8-pixel column bytes
2nd 8-pixel column bytes
...</pre>

<p>Example:</p>

<pre>A sprite 16x2 pixels:

 7 6 5 4 3 2 1 0 7 6 5 4 3 2 1 0
░░░░████████░░░░██░░░░░░░░░░░░██ 0
░░██░░░░░░░░██░░████████████████ 1

db    0b00111100, # 1st column
      0b01000010,

      0b10000001, # 2nd column
      0b11111111</pre>

<p>In an <code>AND+OR</code> (a.k.a. <code>MASK_OR</code>) mode bytes representing shape of a sprite must be intertwined with sprite&#39;s mask bytes:</p>

<pre>1st bitmap byte
1st mask byte
2nd bitmap byte
2nd mask byte
...</pre>

<p>This routine is optimised for vertical sprites with pixel height &gt; width and square ones with width &lt;= 24 pixels.</p>
<dl class="rdoc-list note-list"><dt><code>de</code>
<dd>
<p>An address of sprite data to be drawn.</p>
</dd><dt><code>h</code>
<dd>
<p>A screen vertical (y) coordinate of a sprite&#39;s top-leftmost pixel: [0, 191].</p>
</dd><dt><code>l</code>
<dd>
<p>A screen horizontal (x) coordinate of a sprite&#39;s top-leftmost pixel: [0, 255].</p>
</dd><dt><code>b</code>
<dd>
<p>How many pixel lines to skip from the sprite&#39;s top.</p>
</dd><dt><code>c</code>
<dd>
<p>A width of a sprite in bytes (columns) ((pixel width + 7) / 8): [1, 32].</p>
</dd><dt><code>a&#39;</code>
<dd>
<p>A height of a sprite in pixel lines: [1, 192].</p>
</dd><dt><code>f&#39;</code>
<dd>
<p>Flags specifying a drawing method (see below).</p>
</dd></dl>

<p>To specify a negative vertical coordinate (y &lt; 0) set <code>h</code> (or <code>l</code> see below) to <code>0</code> and <code>b</code> to an absolute value of y.</p>

<p>To specify a negative horizontal coordinate (x &lt; 0):</p>
<ul><li>
<p><code>de</code> should point to the remaining visible sprite columns,</p>
</li><li>
<p><code>c</code> should contain the number of visible sprite columns,</p>
</li><li>
<p>if x modulo 8 is between -1 and -7 then <code>h</code> should contain x modulo 8 as a twos complement negative number and <code>l</code> should contain a vertical coordinate (y) instead.</p>
</li></ul>

<p>Drawing methods:</p>

<pre>  mode:    OR    SET     XOR   AND+OR
    CF:     0      1       0        1
    ZF:     0      0       1        1
how to: ora 1    scf    cp a     cp a
               sbc a              scf</pre>
<dl class="rdoc-list note-list"><dt>Uses
<dd>
<p><code>af</code>, <code>af&#39;</code>, <code>bc</code>, <code>de</code>, <code>hl</code>, <code>bc&#39;</code>, <code>de&#39;</code>, <code>hl&#39;</code>, <code>ix</code>, stack: max 6 bytes, in AND+OR mode also <code>iy</code>.</p>
</dd></dl>

          <div class="method-source-code" id="draw_sprite8-source">
            <pre><span class="ruby-comment"># File lib/zxlib/gfx/sprite8.rb, line 364</span>
<span class="ruby-identifier">ns</span> <span class="ruby-value">:draw_sprite8</span> <span class="ruby-keyword">do</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-constant">CALCULATE_SCREEN_ADDRESS</span> <span class="ruby-operator">==</span> <span class="ruby-value">:external</span>
                <span class="ruby-identifier">push</span> <span class="ruby-identifier">bc</span>             <span class="ruby-comment"># save width and skip</span>
    <span class="ruby-keyword">case</span> <span class="ruby-constant">CALCULATE_SCREEN_ADDRESS</span>
    <span class="ruby-keyword">when</span> <span class="ruby-value">:subroutine</span>
                <span class="ruby-identifier">call</span> <span class="ruby-identifier">calc_scr_addr</span>
    <span class="ruby-keyword">else</span>
                <span class="ruby-identifier">gfx_sprite8_calculate_screen_address</span>(<span class="ruby-value">scraddr:</span><span class="ruby-identifier">sprite8_screen_address</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">skip_addr</span>   <span class="ruby-identifier">push</span> <span class="ruby-identifier">hl</span>             <span class="ruby-comment"># HL: screen addr</span>
                                    <span class="ruby-comment"># C: shift 0..14</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">addr_on_stack</span> <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">maskshift</span>

  <span class="ruby-identifier">select</span>((<span class="ruby-identifier">maskshift</span> <span class="ruby-operator">+</span> <span class="ruby-value">14</span>) <span class="ruby-operator">&amp;</span> <span class="ruby-value">0xFF</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">14</span> }.<span class="ruby-identifier">then</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">_</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">b</span>, <span class="ruby-value">0</span>
                <span class="ruby-identifier">add</span>  <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">bc</span>         <span class="ruby-comment"># HL: -&gt; (maskshift + shift)</span>
  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">else</span> <span class="ruby-keyword">do</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, <span class="ruby-identifier">c</span>
                <span class="ruby-identifier">add</span>  <span class="ruby-identifier">l</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">l</span>, <span class="ruby-identifier">a</span>           <span class="ruby-comment"># HL: -&gt; (maskshift + shift)</span>
  <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, [<span class="ruby-identifier">hl</span>]        <span class="ruby-comment"># A: rotate mask</span>

                <span class="ruby-identifier">exx</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">e</span>, <span class="ruby-identifier">a</span>           <span class="ruby-comment"># E: rotate mask</span>
                <span class="ruby-identifier">pop</span>  <span class="ruby-identifier">hl</span>             <span class="ruby-comment"># HL: screen addr</span>
                <span class="ruby-identifier">exx</span>                 <span class="ruby-comment"># E&#39;: rotate mask, H&#39;L&#39;: screen addr</span>

                <span class="ruby-identifier">ex</span>   <span class="ruby-identifier">af</span>, <span class="ruby-identifier">af</span>         <span class="ruby-comment"># A: height + CZ</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">b</span>, <span class="ruby-identifier">a</span>           <span class="ruby-comment"># B: height</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, <span class="ruby-identifier">c</span>           <span class="ruby-comment"># A: shift 0..14</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-constant">DRAW_METHOD_XOR</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_OR</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_SET</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_MASK_OR</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Syntax</span>, <span class="ruby-string">&quot;there must be at least one draw method selected&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_XOR</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_OR</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_SET</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_MASK_OR</span>
                <span class="ruby-identifier">jr</span>   <span class="ruby-constant">C</span>, <span class="ruby-identifier">aocskip</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_XOR</span> <span class="ruby-keyword">and</span> <span class="ruby-constant">DRAW_METHOD_OR</span>
                <span class="ruby-identifier">jr</span>   <span class="ruby-constant">NZ</span>, <span class="ruby-identifier">orskip</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_XOR</span>
                <span class="ruby-identifier">add</span>  <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">jr</span>   <span class="ruby-constant">Z</span>, <span class="ruby-identifier">fastxor</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">sprxor</span>.<span class="ruby-identifier">start</span>
                <span class="ruby-identifier">push</span> <span class="ruby-identifier">hl</span>             <span class="ruby-comment"># jump addr</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">jumpxor</span> <span class="ruby-operator">-</span> <span class="ruby-value">2</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skipall</span>
      <span class="ruby-identifier">fastxor</span>   <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">sprxor</span>.<span class="ruby-identifier">fstcopy</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skpfast</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_OR</span>
      <span class="ruby-identifier">orskip</span>    <span class="ruby-identifier">add</span>  <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">jr</span>   <span class="ruby-constant">Z</span>, <span class="ruby-identifier">fastor</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">spror</span>.<span class="ruby-identifier">start</span>
                <span class="ruby-identifier">push</span> <span class="ruby-identifier">hl</span>             <span class="ruby-comment"># jump addr</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">jumpor</span> <span class="ruby-operator">-</span> <span class="ruby-value">2</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skipall</span>
      <span class="ruby-identifier">fastor</span>    <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">spror</span>.<span class="ruby-identifier">fstcopy</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skpfast</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_SET</span> <span class="ruby-keyword">and</span> <span class="ruby-constant">DRAW_METHOD_MASK_OR</span>
    <span class="ruby-identifier">aocskip</span>     <span class="ruby-identifier">jr</span>   <span class="ruby-constant">Z</span>, <span class="ruby-identifier">andskip</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-constant">DRAW_METHOD_SET</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_MASK_OR</span>
    <span class="ruby-identifier">aocskip</span>     <span class="ruby-identifier">label</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_SET</span>
                <span class="ruby-identifier">add</span>  <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">jr</span>   <span class="ruby-constant">Z</span>, <span class="ruby-identifier">fastclr</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">spclror</span>.<span class="ruby-identifier">start</span>
                <span class="ruby-identifier">push</span> <span class="ruby-identifier">hl</span>             <span class="ruby-comment"># jump addr</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">jumpclror</span> <span class="ruby-operator">-</span> <span class="ruby-value">2</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skipall</span>
    <span class="ruby-identifier">fastclr</span>     <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">spclror</span>.<span class="ruby-identifier">fstcopy</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skpfast</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_MASK_OR</span>
    <span class="ruby-identifier">andskip</span>     <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">spandor</span>.<span class="ruby-identifier">start</span>
                <span class="ruby-identifier">add</span>  <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">jr</span>   <span class="ruby-constant">Z</span>, <span class="ruby-identifier">fastaor</span>
                <span class="ruby-identifier">push</span> <span class="ruby-identifier">hl</span>             <span class="ruby-comment"># jump addr</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">jumpandor</span> <span class="ruby-operator">-</span> <span class="ruby-value">4</span>
                <span class="ruby-identifier">add</span>  <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">adda_to</span> <span class="ruby-identifier">h</span>, <span class="ruby-identifier">l</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, [<span class="ruby-identifier">hl</span>]
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">iyl</span>, <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">inc</span>  <span class="ruby-identifier">hl</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, [<span class="ruby-identifier">hl</span>]
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">iyh</span>, <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">inc</span>  <span class="ruby-identifier">hl</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skipal2</span>
    <span class="ruby-identifier">fastaor</span>     <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">hl</span>, <span class="ruby-identifier">spandor</span>.<span class="ruby-identifier">fstcopy</span>
                <span class="ruby-identifier">jp</span>   <span class="ruby-identifier">skpfast</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">DRAW_METHOD_XOR</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_OR</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">DRAW_METHOD_SET</span>
    <span class="ruby-identifier">skipall</span>     <span class="ruby-identifier">adda_to</span> <span class="ruby-identifier">h</span>, <span class="ruby-identifier">l</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">skipal2</span>       <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, [<span class="ruby-identifier">hl</span>]
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">ixl</span>, <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">inc</span>  <span class="ruby-identifier">hl</span>
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, [<span class="ruby-identifier">hl</span>]
                <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">ixh</span>, <span class="ruby-identifier">a</span>
                <span class="ruby-identifier">pop</span>  <span class="ruby-identifier">hl</span>             <span class="ruby-comment"># jump addr</span>
  <span class="ruby-identifier">skpfast</span>       <span class="ruby-identifier">ld</span>   <span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>           <span class="ruby-comment"># height</span>
                <span class="ruby-identifier">pop</span>  <span class="ruby-identifier">bc</span>             <span class="ruby-comment"># skip + width</span>
                <span class="ruby-identifier">sub</span>  <span class="ruby-identifier">b</span>              <span class="ruby-comment"># height - skip top lines</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">CHECK_HEIGHT_SANITY</span>
                <span class="ruby-identifier">ret</span>  <span class="ruby-constant">C</span>              <span class="ruby-comment"># return if skip top &gt; height</span>
                <span class="ruby-identifier">ret</span>  <span class="ruby-constant">Z</span>              <span class="ruby-comment"># return if skip top == height</span>
  <span class="ruby-keyword">end</span>
                <span class="ruby-identifier">jp</span>   (<span class="ruby-identifier">hl</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-constant">CALCULATE_SCREEN_ADDRESS</span> <span class="ruby-operator">==</span> <span class="ruby-value">:subroutine</span>
    <span class="ruby-identifier">calc_scr_addr</span> <span class="ruby-identifier">gfx_sprite8_calculate_screen_address</span>(<span class="ruby-value">scraddr:</span><span class="ruby-identifier">sprite8_screen_address</span>, <span class="ruby-value">subroutine:</span><span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.3.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

